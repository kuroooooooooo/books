<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="communityMapper">

   <insert id="insert" >
   		insert into Bookcommunity(
   			bno, 
   			title, 
   			content, 
   			user_id
   		) values(bookcommunity_SEQ.NEXTVAL,
   				#{title},
   				#{content},
   				#{userId}
   				)
   </insert>
   
   <select id="listPage" resultType="com.books.TO.CommunityTO" parameterType="com.books.TO.Criteria">
		   	select 
		    bno, title, content, user_id, regdate, cnt
		from (
		    select 
		        bno, title, content, user_id, regdate, cnt,
		        row_number() over(order by bno desc) as RNUM
		    from bookcommunity
		    )b
		where RNUM between #{rowStart} and #{rowEnd}
		order by bno desc
   </select>
   
   <select id="listCount" resultType="int">
   	<![CDATA[
   		SELECT count(bno)
   		FROM bookcommunity
   		WHERE bno > 0
   	]]>
   </select>
   
   
   <select id="read" parameterType="int" resultType="com.books.TO.CommunityTO">
   		SELECT bno, title, user_id, content
   		FROM BookCommunity
   		WHERE bno = #{bno}
   </select>
   
  <update id="update" parameterType="com.books.TO.CommunityTO">
  	UPDATE BookCommunity
  	SET title = #{title},
  		content = #{content}
  	WHERE bno = #{bno}
  </update>
  
  <delete id="delete" parameterType="int">
  	DELETE
  	FROM BookCommunity
  	WHERE bno = #{bno}
  </delete>
   
</mapper>